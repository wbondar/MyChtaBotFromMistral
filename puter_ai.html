<!DOCTYPE html>
<html>
<head>
    <title>Puter AI Integration</title>
</head>
<body>
    <script src="https://js.puter.com/v2/"></script>
    <script>
        async function streamResponse(prompt) {
            const response = await puter.ai.chat(prompt, {stream: true});
            let fullResponse = "";
            for await (const part of response) {
                fullResponse += part?.text;
            }
            return fullResponse;
        }

        async function handleRequest(event) {
            const prompt = event.data.prompt;
            const response = await streamResponse(prompt);
            event.source.postMessage({ response: response }, event.origin);
        }

        window.addEventListener('message', handleRequest);
    </script>
</body>
</html>
